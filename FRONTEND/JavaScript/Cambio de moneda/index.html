<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cambio de moneda</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap');

        h1 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 2rem;
            color: #4fd1c5;
            letter-spacing: 2px;
            font-weight: 600;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0e1c26, #12343b);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #contenedor {
            background: #ffffff10;
            backdrop-filter: blur(12px);
            padding: 30px 40px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.25);
            width: 350px;
            text-align: left;
            color: white;
        }

        label {
            font-size: 0.93rem;
            font-weight: 600;
            margin-bottom: 6px;
            display: block;
        }

        input, select {
            width: 100%;
            padding: 12px;
            margin-bottom: 16px;
            border-radius: 10px;
            border: none;
            background: #ffffff25;
            color: white;
            font-size: 1rem;
            outline: none;
            transition: 0.2s;
        }

        #quantity {
            width: 326px;
        }

        select option {
            background-color: #0e1c26;
            color: white;               
            font-size: 1rem;
        }

        input:focus, select:focus {
            background: #ffffff35;
            box-shadow: 0 0 0 2px #4fd1c5;
        }

        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        #changeCurrency {
            width: 100%;
            padding: 14px;
            background: #4fd1c5;
            color: #0e1c26;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: 0.25s;
        }

        #changeCurrency:hover {
            background: #38b2ac;
            transform: translateY(-2px);
        }

        #changeCurrency:active {
            transform: translateY(1px);
        }

        #result {
            margin-top: 20px;
            font-size: 1.3rem;
            font-weight: bold;
            color: #4fd1c5;
            text-align: center;
            min-height: 30px;
        }
    </style>
</head>
<body>
    
    <div id="contenedor">
        <div id="mainText">
            <h1>Money exchange</h1>
        </div>
        <div id="">
            <label for="quantity">Quantity</label>
            <input type="number" name="quantity" id="quantity"><br>
            <label for="currentCurrency">Current Currency</label>
            <select name="currentCurrency" id="currentCurrency"></select><br>

            <!-- SelecciÃ³n de moneda deseada -->
            <label for="wantedCurrency">Wanted Currency</label>
            <select name="wantedCurrency" id="wantedCurrency"></select><br><br>
            <button type="button" id="changeCurrency">Change currency</button>
        </div>
        <div id="result"></div> 
    </div>                      

    <script>
        const currencies = [
            { code: "USD", name: "US Dollar" },
            { code: "EUR", name: "Euro" },
            { code: "GBP", name: "British Pound" },
            { code: "JPY", name: "Japanese Yen" },
            { code: "MXN", name: "Mexican Peso" },
            { code: "ARS", name: "Argentine Peso" },
            { code: "BRL", name: "Brazilian Real" },
            { code: "CAD", name: "Canadian Dollar" },
            { code: "CHF", name: "Swiss Franc" },
            { code: "CLP", name: "Chilean Peso" },
            { code: "CNY", name: "Chinese Yuan" },
            { code: "COP", name: "Colombian Peso" },
            { code: "CZK", name: "Czech Koruna" },
            { code: "DKK", name: "Danish Krone" },
            { code: "HKD", name: "Hong Kong Dollar" },
            { code: "HUF", name: "Hungarian Forint" },
            { code: "INR", name: "Indian Rupee" },
            { code: "KRW", name: "South Korean Won" },
            { code: "NOK", name: "Norwegian Krone" },
            { code: "NZD", name: "New Zealand Dollar" },
            { code: "PEN", name: "Peruvian Sol" },
            { code: "PLN", name: "Polish Zloty" },
            { code: "RUB", name: "Russian Ruble" },
            { code: "SEK", name: "Swedish Krona" },
            { code: "SGD", name: "Singapore Dollar" },
            { code: "TRY", name: "Turkish Lira" },
            { code: "UYU", name: "Uruguayan Peso" },
            { code: "ZAR", name: "South African Rand" }
        ]

        let quantityInput = document.getElementById('quantity');
        let currentCurrency = document.getElementById('currentCurrency');
        let wantedCurrency = document.getElementById('wantedCurrency');
        const changeButton = document.getElementById('changeCurrency');
        const resultText = document.getElementById('result');

        function loadCurrencies(selectElement) {
            currencies.forEach(currency => {
                const option = document.createElement('option')
                option.value = currency.code;
                option.text = `${currency.code} - ${currency.name}`;
                selectElement.appendChild(option);
            })
        }

        function inputValidation() {
            if (quantityInput.value <= 0 || quantityInput.value === "" || currentCurrency.value === wantedCurrency.value) {
              return false;  
            } 
            
            return true;
        }
        
        function makeURL() {
            
            const validation = inputValidation()

            if (validation) {
                let currencyQuantity = encodeURIComponent(document.getElementById('quantity').value)
                let wantedCurrencyURI = encodeURIComponent(document.getElementById('wantedCurrency').value);
                let currentCurrencyURI = encodeURIComponent(document.getElementById('currentCurrency').value);

                let url = `https://api.exchangerate.host/convert?access_key=72e845380d2cfb60ccc3ea6e9302a292&from=${currentCurrencyURI}&to=${wantedCurrencyURI}&amount=${currencyQuantity}`
                console.log(url)
                return url;
            }  else {
                return null;
            }
        }
        
        async function getData() {
            
            try {
                const url = makeURL()

                if (url) {
                    const response = await fetch(url)
                    if(!response.ok) {
                        throw new Error(`Response status: ${response.status}`);
                    }
                    const result = await response.json();
    
                    console.log(result.query, result.result);
                    return result.result;
                } else {
                    console.log("Se deben cumplir los campos")
                    return false;
                }

            } catch (error) {
                console.error(error.message);
                console.log("Error en la funcion getData");
                return null;
            }
        }

        changeButton.addEventListener('click',async () => {
            
            const result = await getData();
            
            if (result === null) {
                resultText.innerHTML = "Algo no ha ido bien";
            } else if (!result) {
                resultText.innerHTML = "Error al obtener el cambio";
            } else {
                resultText.innerHTML = `${result} ${wantedCurrency.value}`;
            }    
            
        })
        
        loadCurrencies(currentCurrency)
        loadCurrencies(wantedCurrency)
    </script>
</body>
</html>